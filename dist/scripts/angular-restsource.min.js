/**! 
 * angular-restsource v0.2.0
 * Copyright (c) 2013 Ares Project Management LLC <code@prismondemand.com>
 */
!function(){"use strict";var a=function(b,c,d,e){function f(a){return angular.extend(h.httpConfig,a)}function g(a){return angular.forEach(h.responseInterceptors,function(b){a=b(a)}),a}var h=angular.extend({idField:"id",responseInterceptors:[],httpConfig:{},verbs:{}},e),i=this;Object.defineProperty(this,"rootUrl",{get:function(){return d}}),Object.defineProperty(this,"options",{get:function(){return h}}),angular.forEach(h.verbs,function(a,c){i[c]=function(){var c=f(a.apply(i,arguments));return c.url=d+c.url,g(b(c))}}),this.save=function(a,b){return a[h.idField]?i.update(a,f(b)):i.create(a,f(b))},this.clone=function(e){return new a(b,c,d,angular.extend(h,e))}};angular.module("angular-restsource",[]).config(["$provide",function(b){b.provider("restsource",function(){this.provide=function(a,c){return b.provider(a,function(){var a=this,b={idField:"id",httpConfig:{},verbs:{},responseInterceptors:[]},d=!0,e={page:1,perPage:25};this.idField=function(c){return b.idField=c,a},this.httpConfig=function(c){return b.httpConfig=c,a},this.defaultListLimits=function(b,c){return e={page:b,perPage:c},a},this.useBodyResponseInterceptor=function(b){return d=b,a},this.addResponseInterceptor=function(c){return b.responseInterceptors.push(c),a},this.verb=function(c,d){return b.verbs[c]=d,a},this.verb("create",function(a,b){return angular.extend(b||{},{method:"POST",url:"",data:a})}),this.verb("read",function(a,b){return angular.extend(b||{},{method:"GET",url:"/"+a})}),this.verb("update",function(a,c){return angular.extend(c||{},{method:"PUT",url:"/"+a[b.idField],data:a})}),this.verb("list",function(a,b,c){return angular.extend(c||{},{method:"GET",url:"",params:{page:a||e.page,perPage:b||e.perPage}})}),this.verb("delete",function(a,b){return angular.extend(b||{},{method:"DELETE",url:"/"+a})}),this.$get=function(a,e){d&&b.responseInterceptors.unshift("bodyResponseInterceptor");var f=[];return angular.forEach(b.responseInterceptors,function(b){f.push(angular.isString(b)?a.get(b):a.invoke(b))}),b.responseInterceptors=f,e(c,b)},this.$get.$inject=["$injector","restsource"]})},this.$get=function(b,c){return function(d,e){return new a(b,c,d,e)}},this.$get.$inject=["$http","$q"]}),b.factory("bodyResponseInterceptor",["$q",function(a){return function(b){var c=b.then(function(b){return b.data.error||!b.data.body?a.reject(b):b.data.body});return c.success=function(a){return b.then(function(b){a(b.data.body,b.status,b.headers,b.config)}),c},c.error=function(a){return b.then(null,function(b){a(b.data.error,b.status,b.headers,b.config)}),c},c}}])}])}();