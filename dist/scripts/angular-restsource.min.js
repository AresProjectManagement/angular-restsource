/**! 
 * angular-restsource v0.2.7
 * Copyright (c) 2013 Ares Project Management LLC <code@prismondemand.com>
 */
!function(){"use strict";var a=function(b,c,d,e,f,g){function h(a){return angular.extend({},l.httpConfig,a)}function i(a){return l.responseInterceptors.reduce(function(a,b){try{return angular.isFunction(b.request)?b.request(a):a}catch(c){return e.error(c),a}},a)}function j(a){return l.responseInterceptors.reduce(function(a,b){return angular.isFunction(b)?b(a):angular.isFunction(b.response)?a.then(b.response):(e.warn("**** invalid response interceptor"),a)},a)}function k(a,b){if(!a)return a;var c=a.match(/{{[\w_\.]+}}/g);if(!c)return a;var e=angular.extend({},l.pathParams,b);return c.reduce(function(a,b){var c=b.replace(/[\{\}]+/g,""),f=d(c)(e);return a.replace(b,angular.isFunction(f)?f():f)},a)}var l=angular.extend({idField:"id",responseInterceptors:[],httpConfig:{},verbs:{},pathParams:{}},g),m=this;Object.defineProperty(this,"rootUrl",{get:function(){return f}}),Object.defineProperty(this,"options",{get:function(){return l}}),angular.forEach(l.verbs,function(a,c){m[c]=function(){var c=h(a.apply(m,arguments));return c.url=k(f+c.url,c.pathParams),j(b(i(c)))}}),this.save=function(a,b){return a[l.idField]?m.update(a,h(b)):m.create(a,h(b))},this.clone=function(g){return new a(b,c,d,e,f,angular.extend({},l,g))}};angular.module("angular-restsource",[]).config(["$provide",function(b){b.provider("restsource",function(){var c=this,d={idField:"id",httpConfig:{},verbs:{},responseInterceptors:[],pathParams:{}},e=!0,f={page:1,perPage:25};this.idField=function(a){return d.idField=a,c},this.httpConfig=function(a){return d.httpConfig=a,c},this.defaultListLimits=function(a,b){return f={page:a,perPage:b},c},this.useBodyResponseInterceptor=function(a){return e=a,c},this.addResponseInterceptor=function(a){return d.responseInterceptors.push(a),c},this.pathParams=function(a){return d.pathParams=a,c},this.provide=function(a,c){return b.provider(a,function(){var a=this,b=angular.copy(d),g=angular.copy(e),h=angular.copy(f);this.idField=function(c){return b.idField=c,a},this.httpConfig=function(c){return b.httpConfig=c,a},this.defaultListLimits=function(b,c){return h={page:b,perPage:c},a},this.useBodyResponseInterceptor=function(b){return g=b,a},this.addResponseInterceptor=function(c){return b.responseInterceptors.push(c),a},this.pathParams=function(c){return b.pathParams=c,a},this.verb=function(c){var d,e,f=Array.prototype.slice.call(arguments);return 3===f.length?(e=f[1],d=f[2]):2===f.length&&(angular.isString(f[1])?(e=f[1],d=b.verbs[c]):angular.isFunction(f[1])&&(d=f[1])),b.verbs[c]=e?function(){var a=d.apply({},arguments);return a.url=e,a}:d,a},this.verb("create",function(a,b){return angular.extend({method:"POST",url:"",pathParams:a,data:a},b)}),this.verb("read",function(a,b){return angular.extend({method:"GET",url:"/{{id}}",pathParams:{id:a}},b)}),this.verb("update",function(a,b){return angular.extend({method:"PUT",url:"/{{id}}",pathParams:a,data:a},b)}),this.verb("list",function(a,b,c){return angular.extend({method:"GET",url:"",params:{page:a||h.page,perPage:b||h.perPage}},c)}),this.verb("delete",function(a,b){return angular.extend({method:"DELETE",url:"/{{id}}",pathParams:angular.isObject(a)?a:{id:a},data:angular.isObject(a)?a:void 0},b)}),this.$get=function(a,d){g&&b.responseInterceptors.unshift("bodyResponseInterceptor");var e=[];return angular.forEach(b.responseInterceptors,function(b){e.push(angular.isString(b)?a.get(b):a.invoke(b))}),b.responseInterceptors=e,(angular.isString(b.pathParams)||angular.isFunction(b.pathParams)||angular.isArray(b.pathParams))&&(b.pathParams=angular.isString(b.pathParams)?a.get(b.pathParams):a.invoke(b.pathParams)),d(c,b)},this.$get.$inject=["$injector","restsource"]})},this.$get=function(b,c,d,e){return function(f,g){return new a(b,c,d,e,f,g)}},this.$get.$inject=["$http","$q","$parse","$log"]}),b.factory("bodyResponseInterceptor",["$q",function(a){return function(b){var c=b.then(function(b){var c=b.data||{};return c.error||void 0===c.body?a.reject(b):c.body});return c.success=function(a){return b.then(function(b){var c=b.data||{};a(c.body,b.status,b.headers,b.config)}),c},c.error=function(a){return b.then(null,function(b){var c=b.data||{};a(c.error||{},b.status,b.headers,b.config)}),c},c}}])}])}();